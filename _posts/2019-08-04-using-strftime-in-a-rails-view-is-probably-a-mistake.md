---
layout: post
title: "Возможно, это ошибка использовать strftime в Rails view"
date: 2019-08-04T16:21:00Z
categories: Rails

---

> Автор оригинала - [Andy Croll](https://andycroll.com/ruby/using-strftime-in-a-rails-view-is-probably-a-mistake/)

Функция <span style="color:red">strftime</span> присутствует во многих языках программирования [вплоть до языка C](https://en.wikipedia.org/wiki/C_date_and_time_functions#strftime). Синтаксис аргументов форматирования фактически не изменился за года и на удивление почти одинаковый во всех языках. 

Версия для Ruby полностью описана в документации к [классу Time](https://ruby-doc.org/core-2.6.3/Time.html#method-i-strftime).

Однако, использование функции <span style="color:red">strftime</span> с большей вероятностью может привести к путанице и неопределенности. 

## Вместо...

...использования <span style="color:red">strftime</span> в ваших views для форматирования даты и времени

```erb
<%= @user.last_signed_in_at.strftime("%m-%e-%y %H:%M") %>
```

## Используй…
… встроенные в Rails форматы даты и времени. Или добавь их, как это делаю я, создав свой <span style="color:red">:stamp</span> формат для <span style="color:red">Date</span> и <span style="color:red">Time</span>.

#### <span style="color:darkorange">config/initializers/time_formats.rb</span>

```ruby
Date::DATE_FORMATS[:stamp] = "%Y%m%d" # YYYYMMDD
Time::DATE_FORMATS[:stamp] = "%Y%m%d%H%M%S" # YYYYMMDDHHMMSS
```

Тогда в ваших views:

```erb
<%= @user.last_signed_in_at.to_s(:stamp) %>
```

### Почему?

Используя функцию с запутанным и сложным аргументом ты каждый раз можешь использовать её по другому, что ведет к неопределенности. 

Главное преимущество использования глобально настроенного форматирования заключается в помощи остальным разработчикам, которые придут после тебя включая “будущего” себя самого же. Как результат - строго определенное количество путей для представления времени в твоем приложении. Это пощадит будущих разработчиков от написания кучи своих форматов.  

Пользователь тоже выигрывает от такого подхода. Если дата и время всегда отображаются одинаково - пользователю легче и удобней их читать. Убедись, например, что пользователь всегда видит "11 Окт”, а не “Окт 11”. Мелочь, но думаю, того стоит. 

Вот несколько ресурсов, которые помогут тебе <%=username%> выбрать нужное форматирование для даты:

[For A Good Strftime](https://www.foragoodstrftime.com/)  -  содержит в красивом виде набор возможных вариантов для <span style="color:red">strftime</span> и позволит в живом режиме сконфигурировать любой формат.

[Strftimer](http://strftimer.com/) - даёт возможность ввести дату в нужном формате, а затем возвращает вам формат для <span style="color:red">strftime</span>, который и будет форматировать дату в изначально заданный формат.

Я никогда не мог запомнить форматы <span style="color:red">Date</span> и <span style="color:red">Time</span> которые, предоставляются по умолчанию, плюс ко всему, их сложно найти в документации и поэтому я создал страницу с стандартными [форматами даты и времени в Rails](https://railsdatetimeformats.com/). 

### Почему нет?

При использовании <span style="color:red">strftime</span> в Rails view нет никакой проблемы с производительностью. Здесь самое главное организация и последовательность.


